-- Creacion de la base de datos y sus tablas
CREATE DATABASE IF NOT EXISTS tp_clima_bot CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE tp_clima_bot;

CREATE TABLE chats (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) DEFAULT 'Chat',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE messages (
  id INT AUTO_INCREMENT PRIMARY KEY,
  chat_id INT NOT NULL,
  sender ENUM('user','bot') NOT NULL,
  text TEXT NOT NULL,
  metadata JSON NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (chat_id) REFERENCES chats(id) ON DELETE CASCADE
);